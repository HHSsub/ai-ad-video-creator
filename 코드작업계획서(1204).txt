ğŸ¯ AI ê´‘ê³ ì˜ìƒì œì‘ ì›Œí¬í”Œë¡œìš° ê°œí¸ - ì½”ë“œ ìˆ˜ì • ê³„íšì„œ
ì‘ì„±ì¼: 2025-12-04
ëŒ€ìƒ í”„ë¡œì íŠ¸: ai-ad-video-creator (UPNEXX)
ê°œí¸ ëª©í‘œ: ì´ë¯¸ì§€ ìƒì„± í›„ ê²€í†  â†’ ì„ íƒì  ì˜ìƒ ë³€í™˜ â†’ í•©ì„±
0. í˜„ì¬ ì½”ë“œ ì „ì²´ êµ¬ì¡° ìš”ì•½
í”„ë¡ íŠ¸ì—”ë“œ (React + Vite)
src/
â”œâ”€â”€ App.jsx                    # ë©”ì¸ ë¼ìš°í„° (Step1-4 ê´€ë¦¬, í”„ë¡œì íŠ¸/ëª¨ë“œ ì„ íƒ)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Step1Auto.jsx          # Auto ëª¨ë“œ ì •ë³´ ì…ë ¥
â”‚   â”œâ”€â”€ Step1Manual.jsx        # Manual ëª¨ë“œ ì •ë³´ ì…ë ¥
â”‚   â”œâ”€â”€ Step2.jsx              # Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ ìƒì„± (ì „ì²´ íŒŒì´í”„ë¼ì¸)
â”‚   â”œâ”€â”€ Step3.jsx              # 3ê°œ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° â†’ 1ê°œ ì„ íƒ â†’ BGM ì ìš©
â”‚   â”œâ”€â”€ Step4.jsx              # ì”¬ë³„ í¸ì§‘ (í”„ë¡¬í”„íŠ¸ ìˆ˜ì • â†’ ì´ë¯¸ì§€ ì¬ìƒì„± â†’ ì˜ìƒ ì¬ìƒì„±)
â”‚   â”œâ”€â”€ ProjectDashboard.jsx   # í”„ë¡œì íŠ¸ ëª©ë¡
â”‚   â”œâ”€â”€ ModeSelector.jsx       # Auto/Manual ëª¨ë“œ ì„ íƒ
â”‚   â””â”€â”€ admin/AdminPanel.jsx   # ê´€ë¦¬ì íŒ¨ë„
â””â”€â”€ utils/
    â”œâ”€â”€ apiHelpers.js          # Freepik, Gemini API ë˜í¼
    â”œâ”€â”€ sessionStore.js        # ì„¸ì…˜ ê´€ë¦¬
    â””â”€â”€ engineConfigLoader.js  # engines.json ë¡œë“œ
ë°±ì—”ë“œ API (Node.js + Express)
api/
â”œâ”€â”€ storyboard-init.js         # ğŸ”¥ í•µì‹¬: Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ ì „ì²´ íŒŒì´í”„ë¼ì¸
â”œâ”€â”€ storyboard-render-image.js # Freepik ì´ë¯¸ì§€ ìƒì„±
â”œâ”€â”€ image-to-video.js          # Freepik ì˜ìƒ ìƒì„±
â”œâ”€â”€ compile-videos.js          # FFmpeg ì˜ìƒ í•©ì„±
â”œâ”€â”€ apply-bgm.js               # BGM ì ìš©
â”œâ”€â”€ projects/index.js          # í”„ë¡œì íŠ¸ CRUD
â””â”€â”€ session/
    â”œâ”€â”€ start.js               # ì„¸ì…˜ ì‹œì‘
    â”œâ”€â”€ status/[sessionId].js  # ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ
    â””â”€â”€ clear.js               # ì„¸ì…˜ í´ë¦¬ì–´
ì£¼ìš” ë°ì´í„° íë¦„ (í˜„ì¬)
App.jsx â†’ currentView stateë¡œ Step1~4 ì „í™˜
Step2.jsx â†’ handleGenerateStoryboard() â†’ /api/storyboard-init POST
storyboard-init.js:
Gemini API â†’ JSON íŒŒì‹± â†’ 3ê°œ ì»¨ì…‰ êµ¬ì¡° ìƒì„±
ê° ì»¨ì…‰ì˜ ì´ë¯¸ì§€ ìƒì„± (generateImage())
ê° ì´ë¯¸ì§€ â†’ ì˜ìƒ ë³€í™˜ (generateVideo())
ì˜ìƒ í•©ì„± (/api/compile-videos)
Step3.jsx â†’ finalVideos ë°°ì—´ í‘œì‹œ â†’ 1ê°œ ì„ íƒ â†’ BGM ì ìš©
Step4.jsx â†’ ì„ íƒëœ ì»¨ì…‰ì˜ ì”¬ë³„ ì´ë¯¸ì§€ í¸ì§‘
1. ê¸°ì¡´ ì›Œí¬í”Œë¡œìš°ì˜ ì‹¤ì œ ì½”ë“œ íë¦„
1.1 App.jsx - Step ì „í™˜ ë¡œì§
// App.jsx: Line 524-548
{currentView === 'step2' && (
  <Step2
    formData={formData}
    storyboard={storyboard}
    setStoryboard={setStoryboard}
    onNext={() => {
      setStep(3);
      setCurrentView('step3');  // â† Step3ìœ¼ë¡œ ì´ë™
    }}
  />
)}

{currentView === 'step3' && (
  <Step3
    storyboard={storyboard}
    selectedConceptId={selectedConceptId}
    onNext={() => {
      setStep(4);
      setCurrentView('step4');  // â† Step4ë¡œ ì´ë™
    }}
  />
)}
1.2 Step2.jsx - ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
// Step2.jsx: Line 482-569
const handleGenerateStoryboard = async () => {
  // 1. ì„¸ì…˜ ì €ì¥
  await fetch('/api/session/start', {...});
  
  // 2. ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ)
  const initResponse = await fetch('/api/storyboard-init', {
    method: 'POST',
    body: JSON.stringify(apiPayload)
  });
  
  // 3. í´ë§ìœ¼ë¡œ ì§„í–‰ë¥  í™•ì¸
  if (initResponse.status === 202) {
    pollAndGenerateImages(data.sessionId);  // â† ì˜ìƒê¹Œì§€ ì™„ë£Œë  ë•Œê¹Œì§€ í´ë§
  }
};
1.3 api/storyboard-init.js - ë°±ì—”ë“œ ì „ì²´ íë¦„
// storyboard-init.js: Line 550-750 (ìš”ì•½)
export default async function handler(req, res) {
  // 1ë‹¨ê³„: Gemini í˜¸ì¶œ
  const geminiResponse = await safeCallGemini(...);
  const parsed = parseUnifiedConceptJSON(geminiResponse);
  
  // 2ë‹¨ê³„: 3ê°œ ì»¨ì…‰ë³„ ì´ë¯¸ì§€ ìƒì„±
  for (let conceptIdx = 0; conceptIdx < 3; conceptIdx++) {
    for (let sceneIdx = 0; sceneIdx < scenes.length; sceneIdx++) {
      const imageUrl = await generateImage(...);  // â† Freepik ì´ë¯¸ì§€ ìƒì„±
      scene.imageUrl = imageUrl;
    }
  }
  
  // 3ë‹¨ê³„: ì´ë¯¸ì§€ â†’ ì˜ìƒ ë³€í™˜ (ğŸ”¥ ì—¬ê¸°ê°€ ì œê±° ëŒ€ìƒ)
  for (let conceptIdx = 0; conceptIdx < 3; conceptIdx++) {
    for (let sceneIdx = 0; sceneIdx < scenes.length; sceneIdx++) {
      const videoUrl = await generateVideo(...);  // â† ì˜ìƒ ìƒì„±
      scene.videoUrl = videoUrl;
    }
  }
  
  // 4ë‹¨ê³„: ì˜ìƒ í•©ì„± (ğŸ”¥ ì—¬ê¸°ë„ ì œê±° ëŒ€ìƒ)
  for (let conceptIdx = 0; conceptIdx < 3; conceptIdx++) {
    const compiledVideoUrl = await compileVideos(...);
    finalVideos.push({conceptId, videoUrl: compiledVideoUrl});
  }
  
  // 5ë‹¨ê³„: ì„¸ì…˜ì— ê²°ê³¼ ì €ì¥
  sessionStore.updateStatus(sessionId, 'completed', {
    styles: concepts,
    finalVideos: finalVideos  // â† Step3ì—ì„œ ì‚¬ìš©
  });
}
1.4 Step3.jsx - ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°
// Step3.jsx: Line 226-267
<div className="grid md:grid-cols-3 gap-4">
  {finalVideos.map((video) => (  // â† finalVideosëŠ” ì»´íŒŒì¼ëœ ì˜ìƒ ëª©ë¡
    <div onClick={() => handleSelectVideo(video.conceptId)}>
      <video src={getVideoSrc(video.videoUrl)} />  // â† ì˜ìƒ ì¬ìƒ
    </div>
  ))}
</div>
1.5 Step4.jsx - ì”¬ë³„ í¸ì§‘
// Step4.jsx: Line 136-193
const handleRegenerateImage = async (sceneNumber) => {
  // ì´ë¯¸ì§€ ì¬ìƒì„±
  const response = await fetch('/api/storyboard-render-image', {...});
  scene.imageUrl = result.url;
  scene.videoUrl = null;  // ì˜ìƒì€ ë‹¤ì‹œ ìƒì„± í•„ìš”
};

const handleRegenerateAllVideos = async () => {
  // ìˆ˜ì •ëœ ì”¬ë“¤ë§Œ ì˜ìƒ ë³€í™˜
  for (const sceneNumber of modifiedScenes) {
    await fetch('/api/image-to-video', {...});
  }
  
  // ì „ì²´ í•©ì„±
  await fetch('/api/compile-videos', {...});
};
2. ì‹  ì›Œí¬í”Œë¡œìš°ì™€ ë¹„êµí•˜ì—¬ ì–´ë–¤ ë¶€ë¶„ì´ ë³€ê²½ë˜ëŠ”ì§€
2.1 í•µì‹¬ ë³€ê²½ì  ìš”ì•½í‘œ
í•­ëª©	êµ¬ë²„ì „	ì‹ ë²„ì „	ë³€ê²½ ì‚¬í•­
Step2 ì‘ì—…	Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ	Gemini â†’ ì´ë¯¸ì§€ ê¹Œì§€ë§Œ	ì˜ìƒ ìƒì„± ì œê±°
Step3 í‘œì‹œ	3ê°œ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°	3ê°œ ì´ë¯¸ì§€ ì„¸íŠ¸ ë¯¸ë¦¬ë³´ê¸°	UI ì „ë©´ ë³€ê²½
Step3 ì„ íƒ	ì˜ìƒ 1ê°œ ì„ íƒ	ì´ë¯¸ì§€ ì„¸íŠ¸ 1ê°œ ì„ íƒ	ë°ì´í„° êµ¬ì¡° ë³€ê²½
Step4 ì—­í• 	ì„ íƒëœ ì˜ìƒì˜ ì”¬ í¸ì§‘	ì´ë¯¸ì§€ í¸ì§‘ + ì„ íƒì  ì˜ìƒ ë³€í™˜	ê¸°ëŠ¥ ëŒ€í­ í™•ì¥
ì˜ìƒ ìƒì„± ì‹œì 	Step2ì—ì„œ ìë™	Step4ì—ì„œ ì‚¬ìš©ì ì„ íƒ ì‹œ	íƒ€ì´ë° ë³€ê²½
ìµœì¢… í•©ì„±	Step4 ë‚´ë¶€	Step4 ë‚´ë¶€ (ë™ì¼)	ìœ ì§€
BGM ì ìš©	Step3 ë˜ëŠ” Step4	Step4 (ë™ì¼)	ìœ ì§€
2.2 ë°ì´í„° êµ¬ì¡° ë³€ê²½
êµ¬ë²„ì „ storyboard êµ¬ì¡°
{
  styles: [
    {
      concept_id: 1,
      concept_name: "ì»¨ì…‰ A",
      images: [
        { sceneNumber: 1, imageUrl: "...", videoUrl: "...", status: "video_done" },
        { sceneNumber: 2, imageUrl: "...", videoUrl: "...", status: "video_done" }
      ]
    }
  ],
  finalVideos: [  // â† Step2ì—ì„œ ìƒì„±
    { conceptId: 1, videoUrl: "/videos/compiled/xxx.mp4" },
    { conceptId: 2, videoUrl: "/videos/compiled/yyy.mp4" },
    { conceptId: 3, videoUrl: "/videos/compiled/zzz.mp4" }
  ]
}
ì‹ ë²„ì „ storyboard êµ¬ì¡°
{
  styles: [
    {
      concept_id: 1,
      concept_name: "ì»¨ì…‰ A",
      images: [
        { sceneNumber: 1, imageUrl: "...", videoUrl: null, status: "image_done" },  // â† videoUrlì€ null
        { sceneNumber: 2, imageUrl: "...", videoUrl: null, status: "image_done" }
      ]
    }
  ],
  finalVideos: [],  // â† Step2ì—ì„œëŠ” ë¹„ì–´ìˆìŒ, Step4ì—ì„œ ìƒì„±
  imageSetMode: true  // â† ì‹ ê·œ í”Œë˜ê·¸
}
3. ìˆ˜ì •í•´ì•¼ í•˜ëŠ” íŒŒì¼ ëª©ë¡ ì „ì²´
3.1 ë°±ì—”ë“œ (í•„ìˆ˜ ìˆ˜ì •)
íŒŒì¼ëª…	ìˆ˜ì • íƒ€ì…	ìš°ì„ ìˆœìœ„
api/storyboard-init.js	ğŸ”¥ í•µì‹¬ ìˆ˜ì •	P0 (ìµœìš°ì„ )
api/image-to-video.js	ğŸ“ ê¸°ëŠ¥ ìœ ì§€ (í˜¸ì¶œ ì‹œì ë§Œ ë³€ê²½)	P1
api/compile-videos.js	ğŸ“ ê¸°ëŠ¥ ìœ ì§€	P1
api/apply-bgm.js	ğŸ“ ê¸°ëŠ¥ ìœ ì§€	P2
3.2 í”„ë¡ íŠ¸ì—”ë“œ (í•„ìˆ˜ ìˆ˜ì •)
íŒŒì¼ëª…	ìˆ˜ì • íƒ€ì…	ìš°ì„ ìˆœìœ„
src/components/Step2.jsx	ğŸ”¥ í•µì‹¬ ìˆ˜ì •	P0
src/components/Step3.jsx	ğŸ”¥ í•µì‹¬ ìˆ˜ì • (UI ì „ë©´ ê°œí¸)	P0
src/components/Step4.jsx	ğŸ”¥ ëŒ€í­ í™•ì¥	P0
src/App.jsx	ğŸ“ ì†Œê·œëª¨ ìˆ˜ì •	P1
3.3 ìœ í‹¸ë¦¬í‹° (ì„ íƒì  ìˆ˜ì •)
íŒŒì¼ëª…	ìˆ˜ì • íƒ€ì…	ìš°ì„ ìˆœìœ„
src/utils/sessionStore.js	ğŸ“ ë°ì´í„° êµ¬ì¡° í™•ì¥	P2
src/utils/apiHelpers.js	ğŸ“ ê¸°ëŠ¥ ìœ ì§€	P3
4. íŒŒì¼ë³„ ìˆ˜ì • í¬ì¸íŠ¸ (í•¨ìˆ˜ëª…/ìƒíƒœ/prop íë¦„/ë°±ì—”ë“œ API ì—°ê´€)
4.1 api/storyboard-init.js (ğŸ”¥ ìµœìš°ì„  í•µì‹¬)
í˜„ì¬ ì½”ë“œ íë¦„
// Line 550-850 (ìš”ì•½)
async function handler(req, res) {
  // 1ë‹¨ê³„: Gemini í˜¸ì¶œ
  const geminiResponse = await safeCallGemini(...);
  const parsed = parseUnifiedConceptJSON(geminiResponse);
  
  // 2ë‹¨ê³„: ì´ë¯¸ì§€ ìƒì„± (ìœ ì§€)
  for (conceptIdx...) {
    for (sceneIdx...) {
      imageUrl = await generateImage(...);
    }
  }
  
  // ğŸ”¥ 3ë‹¨ê³„: ì˜ìƒ ìƒì„± (ì œê±° ëŒ€ìƒ)
  for (conceptIdx...) {
    for (sceneIdx...) {
      videoUrl = await generateVideo(...);  // â† ì´ ë¶€ë¶„ ì œê±°
    }
  }
  
  // ğŸ”¥ 4ë‹¨ê³„: ì˜ìƒ í•©ì„± (ì œê±° ëŒ€ìƒ)
  for (conceptIdx...) {
    compiledVideoUrl = await compileVideos(...);  // â† ì´ ë¶€ë¶„ ì œê±°
  }
  
  // 5ë‹¨ê³„: ê²°ê³¼ ë°˜í™˜
  return { styles: concepts, finalVideos: finalVideos };
}
ìˆ˜ì • ê³„íš
// ğŸ”¥ ìˆ˜ì • í›„
async function handler(req, res) {
  // 1ë‹¨ê³„: Gemini í˜¸ì¶œ (ë™ì¼)
  const geminiResponse = await safeCallGemini(...);
  const parsed = parseUnifiedConceptJSON(geminiResponse);
  
  // 2ë‹¨ê³„: ì´ë¯¸ì§€ ìƒì„± (ë™ì¼)
  for (conceptIdx...) {
    for (sceneIdx...) {
      imageUrl = await generateImage(...);
      scene.imageUrl = imageUrl;
      scene.videoUrl = null;  // â† ëª…ì‹œì ìœ¼ë¡œ null ì„¤ì •
      scene.status = 'image_done';  // â† ìƒíƒœ ë³€ê²½
    }
  }
  
  // ğŸ”¥ 3, 4ë‹¨ê³„ ì œê±° (ì˜ìƒ ìƒì„± ë° í•©ì„± ë¡œì§ ì‚­ì œ)
  
  // 5ë‹¨ê³„: ê²°ê³¼ ë°˜í™˜ (ì´ë¯¸ì§€ë§Œ)
  sessionStore.updateStatus(sessionId, 'completed', {
    styles: concepts,
    finalVideos: [],  // â† ë¹ˆ ë°°ì—´
    imageSetMode: true,  // â† ì‹ ê·œ í”Œë˜ê·¸
    metadata: {
      mode: 'image_only',
      totalImages: totalImageCount,
      completedAt: new Date().toISOString()
    }
  });
}
ìƒì„¸ ìˆ˜ì • í¬ì¸íŠ¸
Line 600-700 (generateVideo() í˜¸ì¶œ ë£¨í”„): ì „ì²´ ì œê±°
Line 700-800 (compileVideos() í˜¸ì¶œ ë£¨í”„): ì „ì²´ ì œê±°
Line 800-850 (ê²°ê³¼ ë°˜í™˜ ë¶€ë¶„): finalVideos: []ë¡œ ë³€ê²½
ì§„í–‰ë¥  ì—…ë°ì´íŠ¸:
í˜„ì¬: IMAGE(40%) â†’ VIDEO(80%) â†’ COMPOSE(95%)
ìˆ˜ì •: IMAGE(40% â†’ 95%) (ì˜ìƒ/í•©ì„± ë‹¨ê³„ ì œê±°)
4.2 src/components/Step2.jsx
í˜„ì¬ ì½”ë“œ
// Step2.jsx: Line 417-480
const pollAndGenerateImages = async (sessionId) => {
  const pollInterval = setInterval(async () => {
    const response = await fetch(`/api/session/status/${sessionId}`);
    const data = await response.json();
    
    // ğŸ”¥ ì˜ìƒ ìƒì„±ê¹Œì§€ ì™„ë£Œ ëŒ€ê¸°
    if (data.session.status === 'completed' && data.session.result) {
      const result = data.session.result;
      const { styles, metadata, compositingInfo } = result;
      
      setStoryboard(result);  // â† finalVideos í¬í•¨
      setPercent(100);
      
      // ğŸ”¥ Step3ìœ¼ë¡œ ìë™ ì´ë™
      setTimeout(() => onNext(), 2000);
    }
  }, 3000);
};
ìˆ˜ì • ê³„íš
// ğŸ”¥ ìˆ˜ì • í›„
const pollAndGenerateImages = async (sessionId) => {
  const pollInterval = setInterval(async () => {
    const response = await fetch(`/api/session/status/${sessionId}`);
    const data = await response.json();
    
    // ğŸ”¥ ì´ë¯¸ì§€ ìƒì„±ê¹Œì§€ë§Œ ì™„ë£Œ í™•ì¸
    if (data.session.status === 'completed' && data.session.result) {
      const result = data.session.result;
      
      // âœ… imageSetMode í™•ì¸
      if (result.imageSetMode) {
        setStoryboard(result);  // â† finalVideosëŠ” ë¹ˆ ë°°ì—´
        setPercent(100);
        
        log('âœ… ì´ë¯¸ì§€ ì„¸íŠ¸ ìƒì„± ì™„ë£Œ! Step3ìœ¼ë¡œ ì´ë™...');
        setTimeout(() => onNext(), 2000);
      }
    }
  }, 3000);
};
UI ë³€ê²½
// Line 644-688 (ì»¨ì…‰ ë¯¸ë¦¬ë³´ê¸°)
{styles && styles.length > 0 && (
  <div className="mb-6">
    <h3 className="text-xl font-semibold text-white mb-4">
      ìƒì„±ëœ ì´ë¯¸ì§€ ì„¸íŠ¸ ë¯¸ë¦¬ë³´ê¸°  {/* â† í…ìŠ¤íŠ¸ ë³€ê²½ */}
    </h3>
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {styles.map((style, idx) => (
        <div key={idx} className="bg-gray-900/50 rounded-lg p-4 border border-gray-700">
          <h4 className="font-semibold text-white">ì»¨ì…‰ {idx + 1}</h4>
          
          {/* ğŸ”¥ ì´ë¯¸ì§€ë§Œ í‘œì‹œ (ì˜ìƒ í‘œì‹œ ì œê±°) */}
          <div className="mt-3 grid grid-cols-2 gap-2">
            {style.images.slice(0, 4).map((img, imgIdx) => (
              <img
                key={imgIdx}
                src={img.imageUrl || img.url}  // â† ì´ë¯¸ì§€ë§Œ
                alt={`Scene ${img.sceneNumber}`}
                className="w-full h-20 object-cover rounded border border-gray-700"
              />
            ))}
          </div>
          
          <div className="mt-2 text-xs text-gray-500">
            ì´ë¯¸ì§€: {style.images?.length || 0}ê°œ
          </div>
        </div>
      ))}
    </div>
  </div>
)}
4.3 src/components/Step3.jsx (ğŸ”¥ ëŒ€í­ ìˆ˜ì •)
í˜„ì¬ ì½”ë“œ (ì˜ìƒ í‘œì‹œ)
// Step3.jsx: Line 179-201, 226-267
const finalVideos = storyboard?.finalVideos || [];  // â† ì˜ìƒ ëª©ë¡

{finalVideos.map((video) => (
  <div onClick={() => handleSelectVideo(video.conceptId)}>
    <video src={getVideoSrc(video.videoUrl)} />  // â† ì˜ìƒ ì¬ìƒ
  </div>
))}
ìˆ˜ì • ê³„íš (ì´ë¯¸ì§€ ì„¸íŠ¸ í‘œì‹œ)
// ğŸ”¥ ìˆ˜ì • í›„
const styles = storyboard?.styles || [];  // â† ì´ë¯¸ì§€ ì„¸íŠ¸ ëª©ë¡
const [selectedConceptId, setSelectedConceptId] = useState(null);

// âœ… ì´ë¯¸ì§€ ì„¸íŠ¸ ë¯¸ë¦¬ë³´ê¸°
{styles.map((style, idx) => (
  <div
    key={style.concept_id}
    onClick={() => handleSelectConcept(style.concept_id)}
    className={`border-2 rounded-xl p-4 cursor-pointer ${
      selectedConceptId === style.concept_id
        ? 'border-blue-500 shadow-lg'
        : 'border-gray-700'
    }`}
  >
    <h4 className="font-semibold text-white mb-2">
      {style.concept_name || `ì»¨ì…‰ ${idx + 1}`}
    </h4>
    
    {/* ğŸ”¥ ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ í‘œì‹œ */}
    <div className="grid grid-cols-2 gap-2 mb-3">
      {style.images.map((img) => (
        <div key={img.sceneNumber} className="relative">
          <img
            src={getImageSrc(img.imageUrl || img.url)}
            alt={`Scene ${img.sceneNumber}`}
            className="w-full aspect-square object-cover rounded-lg border border-gray-600"
          />
          <span className="absolute top-1 left-1 bg-black/70 text-white text-xs px-2 py-0.5 rounded">
            #{img.sceneNumber}
          </span>
        </div>
      ))}
    </div>
    
    <div className="text-xs text-gray-400">
      ì”¬ ê°œìˆ˜: {style.images.length}ê°œ
    </div>
    
    {selectedConceptId === style.concept_id && (
      <div className="mt-2 text-xs text-blue-400 font-medium">
        âœ“ ì„ íƒë¨
      </div>
    )}
  </div>
))}
ìƒˆë¡œìš´ í•¸ë“¤ëŸ¬
const handleSelectConcept = (conceptId) => {
  setSelectedConceptId(conceptId);
  log(`ì»¨ì…‰ ${conceptId} ì„ íƒë¨`);
};

const handleGoToEdit = () => {
  if (!selectedConceptId) {
    setError('í¸ì§‘í•  ì´ë¯¸ì§€ ì„¸íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }
  
  log(`Step4ë¡œ ì´ë™ - ì»¨ì…‰ ID: ${selectedConceptId}`);
  onNext();  // â† Step4ë¡œ ì´ë™
};
BGM ê¸°ëŠ¥ ì œê±° ë˜ëŠ” ì´ë™
í˜„ì¬ Step3ì— ìˆëŠ” BGM ì ìš© ê¸°ëŠ¥ì€ Step4ë¡œ ì´ë™ ë˜ëŠ” ì‚­ì œ (Step4ì—ì„œ ìµœì¢… í•©ì„± í›„ ì ìš©)
4.4 src/components/Step4.jsx (ğŸ”¥ ëŒ€í­ í™•ì¥)
í˜„ì¬ ê¸°ëŠ¥
ì”¬ë³„ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
ì´ë¯¸ì§€ ì¬ìƒì„±
ì˜ìƒ ì¬ìƒì„± (ìˆ˜ì •ëœ ì”¬ë§Œ)
ìµœì¢… í•©ì„±
ì‹ ê·œ ê¸°ëŠ¥ ì¶”ê°€
ì´ë¯¸ì§€ ì„¸íŠ¸ ì „ì²´ ë¯¸ë¦¬ë³´ê¸° (ì²˜ìŒ ì§„ì… ì‹œ)
ì”¬ë³„ ì´ë¯¸ì§€ í¸ì§‘:
í”„ë¡¬í”„íŠ¸ ìˆ˜ì •
ì´ë¯¸ì§€ ì¬ìƒì„±
ì”¬ë³„ ì˜ìƒ ë³€í™˜ ì„ íƒ:
ê°œë³„ ì”¬ì„ ì˜ìƒìœ¼ë¡œ ë³€í™˜ (ì„ íƒì )
ë²„íŠ¼: "ì´ ì”¬ì„ ì˜ìƒìœ¼ë¡œ ë³€í™˜"
ì˜ê²¬ êµí™˜ (ì½”ë©˜íŠ¸):
ì”¬ë³„ ì½”ë©˜íŠ¸ ì…ë ¥
ë©¤ë²„ ê°„ ì˜ê²¬ ê³µìœ 
ìµœì¢… í™•ì • ë° í•©ì„±:
"ëª¨ë“  ì”¬ í™•ì • â†’ ì˜ìƒ ë³€í™˜ â†’ í•©ì„±" ë²„íŠ¼
ì˜ìƒ ë³€í™˜ì´ ì•ˆëœ ì”¬ì€ ìë™ ë³€í™˜
ìƒˆë¡œìš´ State
const [sceneVideoStatus, setSceneVideoStatus] = useState({});  // { sceneNumber: 'converting' | 'done' | null }
const [convertingScenes, setConvertingScenes] = useState(new Set());
const [allScenesConfirmed, setAllScenesConfirmed] = useState(false);
ìƒˆë¡œìš´ í•¸ë“¤ëŸ¬
// ğŸ”¥ ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜
const handleConvertSceneToVideo = async (sceneNumber) => {
  const scene = sortedImages.find(img => img.sceneNumber === sceneNumber);
  if (!scene || !scene.imageUrl) {
    setError('ì´ë¯¸ì§€ê°€ ì—†ì–´ ì˜ìƒìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  
  setConvertingScenes(prev => new Set(prev).add(sceneNumber));
  setSceneVideoStatus(prev => ({ ...prev, [sceneNumber]: 'converting' }));
  
  try {
    const response = await fetch(`${API_BASE}/nexxii/api/image-to-video`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        imageUrl: scene.imageUrl,
        prompt: scene.motionPrompt?.prompt || 'smooth camera movement',
        duration: 2,
        formData: formData
      })
    });
    
    const result = await response.json();
    
    if (result.success && result.task.taskId) {
      // ğŸ”¥ í´ë§ìœ¼ë¡œ ì˜ìƒ ìƒì„± ì™„ë£Œ ëŒ€ê¸°
      await pollVideoStatus(result.task.taskId, sceneNumber);
    } else {
      throw new Error('ì˜ìƒ ë³€í™˜ ì‹¤íŒ¨');
    }
  } catch (err) {
    setError(`ì”¬ ${sceneNumber} ì˜ìƒ ë³€í™˜ ì˜¤ë¥˜: ${err.message}`);
    setSceneVideoStatus(prev => ({ ...prev, [sceneNumber]: null }));
  } finally {
    setConvertingScenes(prev => {
      const newSet = new Set(prev);
      newSet.delete(sceneNumber);
      return newSet;
    });
  }
};

// ì˜ìƒ ìƒíƒœ í´ë§
const pollVideoStatus = async (taskId, sceneNumber) => {
  const maxAttempts = 40;  // 2ë¶„ (3ì´ˆ * 40)
  
  for (let attempt = 0; attempt < maxAttempts; attempt++) {
    await new Promise(resolve => setTimeout(resolve, 3000));
    
    const response = await fetch(`${API_BASE}/nexxii/api/video-status`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ taskId })
    });
    
    const result = await response.json();
    
    if (result.success && result.status === 'COMPLETED') {
      const scene = sortedImages.find(img => img.sceneNumber === sceneNumber);
      scene.videoUrl = result.videoUrl;
      scene.status = 'video_done';
      setSceneVideoStatus(prev => ({ ...prev, [sceneNumber]: 'done' }));
      log(`ì”¬ ${sceneNumber} ì˜ìƒ ë³€í™˜ ì™„ë£Œ`);
      return;
    } else if (result.status === 'FAILED') {
      throw new Error('ì˜ìƒ ìƒì„± ì‹¤íŒ¨');
    }
  }
  
  throw new Error('ì˜ìƒ ìƒì„± íƒ€ì„ì•„ì›ƒ');
};

// ğŸ”¥ ì „ì²´ í™•ì • ë° í•©ì„±
const handleConfirmAndCompile = async () => {
  setLoading(true);
  log('ëª¨ë“  ì”¬ í™•ì • â†’ ì˜ìƒ ë³€í™˜ â†’ í•©ì„± ì‹œì‘');
  
  try {
    // 1ë‹¨ê³„: ì˜ìƒì´ ì—†ëŠ” ì”¬ë“¤ ìë™ ë³€í™˜
    const scenesNeedingVideo = sortedImages.filter(img => !img.videoUrl);
    
    if (scenesNeedingVideo.length > 0) {
      log(`${scenesNeedingVideo.length}ê°œ ì”¬ì„ ì˜ìƒìœ¼ë¡œ ë³€í™˜ ì¤‘...`);
      
      for (const scene of scenesNeedingVideo) {
        await handleConvertSceneToVideo(scene.sceneNumber);
      }
    }
    
    // 2ë‹¨ê³„: ì „ì²´ í•©ì„±
    log('ëª¨ë“  ì”¬ì˜ ì˜ìƒ ë³€í™˜ ì™„ë£Œ. í•©ì„± ì‹œì‘...');
    
    const segments = sortedImages
      .filter(img => img.videoUrl)
      .map(img => ({
        sceneNumber: img.sceneNumber,
        videoUrl: img.videoUrl
      }));
    
    const compileResponse = await fetch(`${API_BASE}/nexxii/api/compile-videos`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        segments: segments,
        videoLength: formData?.videoLength || '10ì´ˆ',
        formData: formData,
        mode: formData?.mode,
        jsonMode: true
      })
    });
    
    const compileResult = await compileResponse.json();
    
    if (compileResult.success && compileResult.compiledVideoUrl) {
      log(`ì˜ìƒ í•©ì„± ì™„ë£Œ: ${compileResult.compiledVideoUrl}`);
      
      // storyboardì— finalVideos ì¶”ê°€
      if (storyboard && !storyboard.finalVideos) {
        storyboard.finalVideos = [];
      }
      
      storyboard.finalVideos.push({
        conceptId: selectedConceptId,
        conceptName: selectedStyle?.conceptName || selectedStyle?.style,
        videoUrl: compileResult.compiledVideoUrl,
        metadata: compileResult.metadata
      });
      
      setAllScenesConfirmed(true);
      log('âœ… ëª¨ë“  ì‘ì—… ì™„ë£Œ! BGM ì ìš© ë˜ëŠ” ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥');
      
      // ì„ íƒì : Step3ìœ¼ë¡œ ë³µê·€ (BGM ì ìš©)
      // onComplete();
    } else {
      throw new Error('ì˜ìƒ í•©ì„± ì‹¤íŒ¨');
    }
  } catch (err) {
    setError(`ì˜ìƒ í™•ì • ë° í•©ì„± ì˜¤ë¥˜: ${err.message}`);
    log(`ì˜¤ë¥˜: ${err.message}`);
  } finally {
    setLoading(false);
  }
};
UI ì¶”ê°€ (ì”¬ë³„ ì˜ìƒ ë³€í™˜ ë²„íŠ¼)
{/* Step4.jsx: ì”¬ë³„ ì¹´ë“œ ë‚´ë¶€ */}
<div className="md:col-span-1 space-y-4">
  {/* ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ í¸ì§‘ */}
  <textarea value={...} onChange={...} />
  
  {/* ê¸°ì¡´ ì´ë¯¸ì§€ ì¬ìƒì„± ë²„íŠ¼ */}
  <button onClick={() => handleRegenerateImage(img.sceneNumber)}>
    ğŸ”„ ì´ë¯¸ì§€ ì¬ìƒì„±
  </button>
  
  {/* ğŸ”¥ ì‹ ê·œ: ì˜ìƒ ë³€í™˜ ë²„íŠ¼ */}
  <button
    onClick={() => handleConvertSceneToVideo(img.sceneNumber)}
    disabled={convertingScenes.has(img.sceneNumber) || loading}
    className="w-full px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50"
  >
    {sceneVideoStatus[img.sceneNumber] === 'converting' 
      ? 'ì˜ìƒ ë³€í™˜ ì¤‘...' 
      : sceneVideoStatus[img.sceneNumber] === 'done'
        ? 'âœ… ì˜ìƒ ë³€í™˜ ì™„ë£Œ'
        : 'ğŸ¬ ì´ ì”¬ì„ ì˜ìƒìœ¼ë¡œ ë³€í™˜'}
  </button>
  
  {/* ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° (ë³€í™˜ ì™„ë£Œ ì‹œ) */}
  {img.videoUrl && (
    <video
      src={getVideoSrc(img.videoUrl)}
      className="w-full rounded-lg bg-black mt-2"
      controls
      muted
    />
  )}
</div>
í•˜ë‹¨ ë²„íŠ¼ ë³€ê²½
{/* Step4.jsx: í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ */}
<div className="flex justify-between pt-6 border-t border-gray-700">
  <button onClick={onPrev}>â† Step3ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
  
  <div className="flex gap-3">
    {/* ğŸ”¥ ì‹ ê·œ: ì „ì²´ í™•ì • ë° í•©ì„± ë²„íŠ¼ */}
    <button
      onClick={handleConfirmAndCompile}
      disabled={loading || allScenesConfirmed}
      className="px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg transition-colors font-medium disabled:opacity-50"
    >
      {loading 
        ? 'ì²˜ë¦¬ ì¤‘...' 
        : allScenesConfirmed
          ? 'âœ… í•©ì„± ì™„ë£Œ'
          : 'ğŸ¬ ëª¨ë“  ì”¬ í™•ì • â†’ ì˜ìƒ í•©ì„±'}
    </button>
    
    {/* BGM ì ìš© ë²„íŠ¼ (í•©ì„± ì™„ë£Œ í›„ì—ë§Œ í‘œì‹œ) */}
    {allScenesConfirmed && (
      <button
        onClick={handleApplyBgm}
        className="px-6 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg"
      >
        ğŸµ BGM ì ìš©
      </button>
    )}
    
    {/* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */}
    {allScenesConfirmed && (
      <button
        onClick={handleDownload}
        className="px-6 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg"
      >
        ğŸ“¥ ë‹¤ìš´ë¡œë“œ
      </button>
    )}
  </div>
</div>
4.5 src/App.jsx
ìˆ˜ì • í¬ì¸íŠ¸
// App.jsx: Line 88-137
const handleSelectProject = async (project) => {
  setCurrentProject(project);
  
  try {
    const response = await fetch(`/nexxii/api/projects/${project.id}`);
    if (response.ok) {
      const data = await response.json();
      
      // ğŸ”¥ ìˆ˜ì •: imageSetMode í™•ì¸ ì¶”ê°€
      if (data.project.storyboard) {
        if (data.project.storyboard.imageSetMode) {
          // ì´ë¯¸ì§€ ì„¸íŠ¸ë§Œ ìˆëŠ” ê²½ìš° â†’ Step3ìœ¼ë¡œ
          console.log('[App] ì´ë¯¸ì§€ ì„¸íŠ¸ ë°œê²¬ - Step3ìœ¼ë¡œ ì´ë™');
          setStoryboard(data.project.storyboard);
          setCurrentView('step3');
          setStep(3);
        } else if (data.project.storyboard.finalVideos?.length > 0) {
          // ì˜ìƒê¹Œì§€ ì™„ì„±ëœ ê²½ìš° â†’ Step4ë¡œ
          console.log('[App] ì™„ì„±ëœ ì˜ìƒ ë°œê²¬ - Step4ë¡œ ì´ë™');
          setStoryboard(data.project.storyboard);
          setCurrentView('step4');
          setStep(4);
        } else {
          // ê¸°íƒ€ ê²½ìš° â†’ Step2ë¡œ
          setCurrentView('step2');
          setStep(2);
        }
        return;
      }
    }
  } catch (error) {
    console.error('[App] í”„ë¡œì íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
  }
  
  // storyboard ì—†ìœ¼ë©´ ëª¨ë“œ ì„ íƒ
  setCurrentView('mode-select');
};
5. ì‹ ê·œë¡œ ìƒì„±í•´ì•¼ í•˜ëŠ” íŒŒì¼ ëª©ë¡
5.1 í•„ìš” ì—¬ë¶€ ê²€í† 
íŒŒì¼	í•„ìš” ì—¬ë¶€	ì´ìœ 
api/video-status.js	âœ… í•„ìš”	Step4ì—ì„œ ê°œë³„ ì˜ìƒ ë³€í™˜ í´ë§ìš©
src/components/ImageSetPreview.jsx	â¬œ ì„ íƒì 	Step3 UI ë¶„ë¦¬ (ê¸°ì¡´ Step3ì— í†µí•© ê°€ëŠ¥)
src/components/SceneVideoConverter.jsx	â¬œ ì„ íƒì 	Step4 UI ë¶„ë¦¬ (ê¸°ì¡´ Step4ì— í†µí•© ê°€ëŠ¥)
5.2 api/video-status.js (ì‹ ê·œ ìƒì„±)
// api/video-status.js - Freepik ì˜ìƒ ìƒì„± ìƒíƒœ ì¡°íšŒ
import { safeCallFreepik } from '../src/utils/apiHelpers.js';
import { getImageToVideoStatusUrl } from '../src/utils/engineConfigLoader.js';

export default async function handler(req, res) {
  res.setHeader('Access-Control-Allow-Origin', '*');
  res.setHeader('Access-Control-Allow-Methods', 'POST, OPTIONS');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type');
  
  if (req.method === 'OPTIONS') return res.status(200).end();
  if (req.method !== 'POST') return res.status(405).json({ error: 'Method not allowed' });
  
  try {
    const { taskId } = req.body;
    
    if (!taskId) {
      return res.status(400).json({ error: 'taskId required' });
    }
    
    console.log(`[video-status] íƒœìŠ¤í¬ ${taskId} ìƒíƒœ ì¡°íšŒ`);
    
    // ğŸ”¥ ë™ì  URL ìƒì„±
    const statusUrl = getImageToVideoStatusUrl(taskId);
    
    const result = await safeCallFreepik(statusUrl, {
      method: 'GET',
      headers: { 'Accept': 'application/json' }
    }, 0, `video-status-${taskId.substring(0, 8)}`);
    
    if (result && result.data) {
      const status = (result.data.status || '').toUpperCase();
      
      if (status === 'COMPLETED') {
        const videoUrl = result.data.video || result.data.generated?.[0];
        
        return res.status(200).json({
          success: true,
          status: 'COMPLETED',
          videoUrl: videoUrl,
          taskId: taskId
        });
      } else if (status === 'FAILED' || status === 'ERROR') {
        return res.status(200).json({
          success: false,
          status: 'FAILED',
          error: 'Video generation failed',
          taskId: taskId
        });
      } else {
        // IN_PROGRESS, PENDING, etc.
        return res.status(200).json({
          success: true,
          status: status,
          taskId: taskId
        });
      }
    } else {
      throw new Error('Invalid API response');
    }
  } catch (error) {
    console.error('[video-status] ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
}
6. ì‚­ì œ ë˜ëŠ” ë¹„í™œì„±í™” í•´ì•¼ í•˜ëŠ” ì½”ë“œ
6.1 api/storyboard-init.js
ì‚­ì œ ëŒ€ìƒ
// ğŸ”¥ Line 600-700: generateVideo() í˜¸ì¶œ ë£¨í”„ ì „ì²´ ì‚­ì œ
for (let conceptIdx = 0; conceptIdx < concepts.length; conceptIdx++) {
  for (let sceneIdx = 0; sceneIdx < scenes.length; sceneIdx++) {
    const videoUrl = await generateVideo(...);  // â† ì´ ë¸”ë¡ ì „ì²´ ì‚­ì œ
    scene.videoUrl = videoUrl;
    updateSession(...);
  }
}

// ğŸ”¥ Line 700-800: compileVideos() í˜¸ì¶œ ë£¨í”„ ì „ì²´ ì‚­ì œ
const finalVideos = [];
for (let conceptIdx = 0; conceptIdx < concepts.length; conceptIdx++) {
  const compiledVideoUrl = await compileVideos(...);  // â† ì´ ë¸”ë¡ ì „ì²´ ì‚­ì œ
  finalVideos.push({...});
}
6.2 src/components/Step3.jsx
ì‚­ì œ ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬
// ğŸ”¥ BGM ì ìš© UI ì „ì²´ ì‚­ì œ (Step4ë¡œ ì´ë™)
<div className="grid md:grid-cols-2 gap-6 mt-6">
  <div className="bg-gray-800/50 rounded-lg p-4 border border-gray-700">
    <h4 className="font-semibold text-white mb-3">ğŸµ BGM ì ìš©</h4>
    <select value={bgmMood} onChange={...}>  {/* â† ì‚­ì œ */}
      ...
    </select>
    <button onClick={handleApplyBgm}>  {/* â† ì‚­ì œ */}
      ğŸµ BGM ì ìš©
    </button>
  </div>
</div>
7. í”„ë¡ íŠ¸/ë°±ì—”ë“œ/ì„œë²„/í”„ë¡¬í”„íŠ¸/ffmpeg ì „ ê³¼ì • ìˆ˜ì • í•­ëª© ì´ì •ë¦¬
7.1 ë°±ì—”ë“œ API ìˆ˜ì • ì´ì •ë¦¬
API ì—”ë“œí¬ì¸íŠ¸	í˜„ì¬ ë™ì‘	ìˆ˜ì • í›„ ë™ì‘	íŒŒì¼
POST /api/storyboard-init	Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ â†’ í•©ì„±	Gemini â†’ ì´ë¯¸ì§€ ê¹Œì§€ë§Œ	api/storyboard-init.js
POST /api/storyboard-render-image	ì´ë¯¸ì§€ ìƒì„±	ë™ì¼ (ë³€ê²½ ì—†ìŒ)	api/storyboard-render-image.js
POST /api/image-to-video	ì˜ìƒ ìƒì„± (Step2ì—ì„œ í˜¸ì¶œ)	ë™ì¼ (Step4ì—ì„œ í˜¸ì¶œ)	api/image-to-video.js
POST /api/video-status	âŒ ì—†ìŒ	âœ… ì‹ ê·œ ìƒì„± (í´ë§ìš©)	api/video-status.js (ì‹ ê·œ)
POST /api/compile-videos	ì „ì²´ í•©ì„±	ë™ì¼ (Step4ì—ì„œ í˜¸ì¶œ)	api/compile-videos.js
POST /api/apply-bgm	BGM ì ìš©	ë™ì¼ (Step4ì—ì„œ í˜¸ì¶œ)	api/apply-bgm.js
GET /api/session/status/:id	ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ	ë°ì´í„° êµ¬ì¡° í™•ì¥	api/session/status/[sessionId].js
7.2 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ ìˆ˜ì • ì´ì •ë¦¬
ì»´í¬ë„ŒíŠ¸	í˜„ì¬ ì—­í• 	ìˆ˜ì • í›„ ì—­í• 	ì£¼ìš” ë³€ê²½
App.jsx	Step ë¼ìš°íŒ…	ë™ì¼ + í”„ë¡œì íŠ¸ ë³µêµ¬ ë¡œì§ ê°•í™”	handleSelectProject() ìˆ˜ì •
Step1Auto.jsx	ì •ë³´ ì…ë ¥	ë™ì¼	ë³€ê²½ ì—†ìŒ
Step1Manual.jsx	ì •ë³´ ì…ë ¥	ë™ì¼	ë³€ê²½ ì—†ìŒ
Step2.jsx	Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ ìƒì„±	Gemini â†’ ì´ë¯¸ì§€ ê¹Œì§€ë§Œ	pollAndGenerateImages() ìˆ˜ì •
Step3.jsx	3ê°œ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° â†’ ì„ íƒ	3ê°œ ì´ë¯¸ì§€ ì„¸íŠ¸ ë¯¸ë¦¬ë³´ê¸° â†’ ì„ íƒ	UI ì „ë©´ ê°œí¸
Step4.jsx	ì”¬ í¸ì§‘ + ì˜ìƒ ì¬ìƒì„±	ì”¬ í¸ì§‘ + ì„ íƒì  ì˜ìƒ ë³€í™˜ + í•©ì„±	ê¸°ëŠ¥ ëŒ€í­ í™•ì¥
7.3 ì„¸ì…˜ ë°ì´í„° êµ¬ì¡° ë³€ê²½
í˜„ì¬ ì„¸ì…˜ êµ¬ì¡°
{
  sessionId: "session_xxx",
  status: "completed",
  result: {
    styles: [...],
    finalVideos: [  // â† ì˜ìƒ í¬í•¨
      { conceptId: 1, videoUrl: "..." },
      { conceptId: 2, videoUrl: "..." },
      { conceptId: 3, videoUrl: "..." }
    ],
    metadata: {...}
  }
}
ìˆ˜ì • í›„ ì„¸ì…˜ êµ¬ì¡°
{
  sessionId: "session_xxx",
  status: "completed",
  result: {
    styles: [...],
    finalVideos: [],  // â† ë¹„ì–´ìˆìŒ
    imageSetMode: true,  // â† ì‹ ê·œ í”Œë˜ê·¸
    metadata: {
      mode: 'image_only',
      totalImages: 15,
      completedAt: "2025-12-04T..."
    }
  }
}
7.4 FFmpeg ê´€ë ¨ ìˆ˜ì •
ì‘ì—…	í˜„ì¬	ìˆ˜ì • í›„
ì˜ìƒ í•©ì„± (compile-videos.js)	Step2ì—ì„œ ìë™ ì‹¤í–‰	Step4ì—ì„œ ì‚¬ìš©ì í™•ì • í›„ ì‹¤í–‰
BGM ì ìš© (apply-bgm.js)	Step3 ë˜ëŠ” Step4	Step4 (í•©ì„± ì™„ë£Œ í›„)
ê°œë³„ ì˜ìƒ ë³€í™˜ (image-to-video.js)	Step2ì—ì„œ ì¼ê´„ ì‹¤í–‰	Step4ì—ì„œ ì„ íƒì  ì‹¤í–‰
8. ë‹¨ê³„ë³„ êµ¬í˜„ ìš°ì„ ìˆœìœ„
Phase 1: ë°±ì—”ë“œ ìˆ˜ì • (1-2ì¼)
ëª©í‘œ: Step2ê°€ ì´ë¯¸ì§€ê¹Œì§€ë§Œ ìƒì„±í•˜ë„ë¡ ë³€ê²½
ìš°ì„ ìˆœìœ„	ì‘ì—…	íŒŒì¼	ì˜ˆìƒ ì‹œê°„
P0-1	storyboard-init.js ì˜ìƒ ìƒì„± ë¡œì§ ì œê±°	api/storyboard-init.js	2ì‹œê°„
P0-2	ì„¸ì…˜ ë°ì´í„° êµ¬ì¡°ì— imageSetMode í”Œë˜ê·¸ ì¶”ê°€	src/utils/sessionStore.js	30ë¶„
P0-3	video-status.js API ì‹ ê·œ ìƒì„±	api/video-status.js (ì‹ ê·œ)	1ì‹œê°„
P1-1	ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ (Postman)	-	1ì‹œê°„
Phase 2: Step2 ìˆ˜ì • (1ì¼)
ëª©í‘œ: ì´ë¯¸ì§€ê¹Œì§€ë§Œ ìƒì„± í›„ Step3ìœ¼ë¡œ ì´ë™
ìš°ì„ ìˆœìœ„	ì‘ì—…	íŒŒì¼	ì˜ˆìƒ ì‹œê°„
P0-4	Step2.jsx í´ë§ ë¡œì§ ìˆ˜ì •	src/components/Step2.jsx	1ì‹œê°„
P0-5	UI í…ìŠ¤íŠ¸ ë³€ê²½ (ì˜ìƒ â†’ ì´ë¯¸ì§€ ì„¸íŠ¸)	src/components/Step2.jsx	30ë¶„
P1-2	í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ (ë¸Œë¼ìš°ì €)	-	1ì‹œê°„
Phase 3: Step3 ì „ë©´ ê°œí¸ (2ì¼)
ëª©í‘œ: ì˜ìƒ ëŒ€ì‹  ì´ë¯¸ì§€ ì„¸íŠ¸ í‘œì‹œ
ìš°ì„ ìˆœìœ„	ì‘ì—…	íŒŒì¼	ì˜ˆìƒ ì‹œê°„
P0-6	ì´ë¯¸ì§€ ì„¸íŠ¸ ê·¸ë¦¬ë“œ UI êµ¬í˜„	src/components/Step3.jsx	3ì‹œê°„
P0-7	ì»¨ì…‰ ì„ íƒ ë¡œì§ êµ¬í˜„	src/components/Step3.jsx	1ì‹œê°„
P0-8	BGM ê¸°ëŠ¥ ì œê±° (Step4ë¡œ ì´ë™)	src/components/Step3.jsx	30ë¶„
P1-3	ë””ìì¸ QA	src/components/Step3.jsx	1ì‹œê°„
Phase 4: Step4 ê¸°ëŠ¥ í™•ì¥ (3-4ì¼)
ëª©í‘œ: ì´ë¯¸ì§€ í¸ì§‘ + ì„ íƒì  ì˜ìƒ ë³€í™˜ + í•©ì„±
ìš°ì„ ìˆœìœ„	ì‘ì—…	íŒŒì¼	ì˜ˆìƒ ì‹œê°„
P0-9	ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜ ë²„íŠ¼ ì¶”ê°€	src/components/Step4.jsx	2ì‹œê°„
P0-10	handleConvertSceneToVideo() êµ¬í˜„	src/components/Step4.jsx	3ì‹œê°„
P0-11	pollVideoStatus() í´ë§ ë¡œì§ êµ¬í˜„	src/components/Step4.jsx	2ì‹œê°„
P0-12	handleConfirmAndCompile() êµ¬í˜„	src/components/Step4.jsx	3ì‹œê°„
P0-13	UI: ì˜ìƒ ë³€í™˜ ìƒíƒœ í‘œì‹œ	src/components/Step4.jsx	1ì‹œê°„
P0-14	UI: BGM ì ìš© ì„¹ì…˜ ì¶”ê°€	src/components/Step4.jsx	1ì‹œê°„
P1-4	í†µí•© í…ŒìŠ¤íŠ¸ (ì „ì²´ í”Œë¡œìš°)	-	2ì‹œê°„
Phase 5: App.jsx ë° í†µí•© (1ì¼)
ëª©í‘œ: í”„ë¡œì íŠ¸ ë³µêµ¬ ë¡œì§ ê°•í™”
ìš°ì„ ìˆœìœ„	ì‘ì—…	íŒŒì¼	ì˜ˆìƒ ì‹œê°„
P1-5	handleSelectProject() ìˆ˜ì •	src/App.jsx	1ì‹œê°„
P1-6	ì „ì²´ í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸	-	2ì‹œê°„
P2-1	ë¬¸ì„œ ì—…ë°ì´íŠ¸ (UPNEXX_ì§€ì‹ë™ê¸°í™”_v3_6.md)	-	1ì‹œê°„
Phase 6: QA ë° ë°°í¬ (1-2ì¼)
ëª©í‘œ: ìµœì¢… ê²€ì¦ ë° í”„ë¡œë•ì…˜ ë°°í¬
ìš°ì„ ìˆœìœ„	ì‘ì—…	ì˜ˆìƒ ì‹œê°„
P2-2	ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (Auto/Manual)	2ì‹œê°„
P2-3	ë²„ê·¸ ìˆ˜ì • ë° ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”	2ì‹œê°„
P2-4	EC2 ë°°í¬ + PM2 ì¬ì‹œì‘	30ë¶„
P2-5	í”„ë¡œë•ì…˜ í™˜ê²½ ìµœì¢… í™•ì¸	1ì‹œê°„
9. ì˜ˆìƒ ë¦¬ìŠ¤í¬ ë° ì¶©ëŒ í¬ì¸íŠ¸
9.1 ë°±ì—”ë“œ ë¦¬ìŠ¤í¬
ë¦¬ìŠ¤í¬	ì˜í–¥ë„	í•´ê²° ë°©ì•ˆ
storyboard-init.js ìˆ˜ì • ì‹œ ê¸°ì¡´ í”„ë¡œì íŠ¸ ë³µêµ¬ ì‹¤íŒ¨	ğŸ”´ HIGH	ë²„ì „ í”Œë˜ê·¸ ì¶”ê°€ (imageSetMode: true)
ì§„í–‰ë¥  ê³„ì‚° ì˜¤ë¥˜ (ì˜ìƒ/í•©ì„± ë‹¨ê³„ ì œê±°)	ğŸŸ¡ MEDIUM	Phase ë³€ê²½: IMAGE(40% â†’ 95%)
ì„¸ì…˜ ë°ì´í„° í˜¸í™˜ì„± (ì‹ /êµ¬ ë²„ì „ í˜¼ì¬)	ğŸŸ¡ MEDIUM	ì¡°ê±´ë¶€ ì²˜ë¦¬ (imageSetMode ì²´í¬)
API ì‘ë‹µ íƒ€ì„ì•„ì›ƒ (ì´ë¯¸ì§€ 15ê°œ ìƒì„± ì‹œ 5-10ë¶„)	ğŸŸ¡ MEDIUM	í˜„ì¬ì™€ ë™ì¼ (ë³€ê²½ ì—†ìŒ)
9.2 í”„ë¡ íŠ¸ì—”ë“œ ë¦¬ìŠ¤í¬
ë¦¬ìŠ¤í¬	ì˜í–¥ë„	í•´ê²° ë°©ì•ˆ
Step3 UI ê°œí¸ ì‹œ ê¸°ì¡´ finalVideos ì²˜ë¦¬	ğŸ”´ HIGH	ì¡°ê±´ë¶€ ë Œë”ë§ (imageSetMode ì²´í¬)
Step4 ì˜ìƒ ë³€í™˜ í´ë§ ë¬´í•œ ëŒ€ê¸°	ğŸŸ¡ MEDIUM	íƒ€ì„ì•„ì›ƒ + ì¬ì‹œë„ ë¡œì§ ì¶”ê°€
ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜ ì‹¤íŒ¨ ì‹œ UX	ğŸŸ¡ MEDIUM	ì˜¤ë¥˜ ë©”ì‹œì§€ + ì¬ì‹œë„ ë²„íŠ¼
ì „ì²´ í•©ì„± ì‹¤íŒ¨ ì‹œ ë¡¤ë°±	ğŸŸ¡ MEDIUM	ì—ëŸ¬ í•¸ë“¤ë§ + ì‚¬ìš©ì ì•ˆë‚´
9.3 ë°ì´í„° êµ¬ì¡° ì¶©ëŒ
ì¶©ëŒ ì‹œë‚˜ë¦¬ì˜¤	ë°œìƒ ì¡°ê±´	í•´ê²° ë°©ì•ˆ
êµ¬ë²„ì „ í”„ë¡œì íŠ¸ ë¡œë“œ	ê¸°ì¡´ í”„ë¡œì íŠ¸ê°€ finalVideos í¬í•¨	imageSetMode ì²´í¬ â†’ ì˜ìƒ ìˆìœ¼ë©´ Step4ë¡œ, ì—†ìœ¼ë©´ Step3ìœ¼ë¡œ
ì„¸ì…˜ ë³µêµ¬ ì‹¤íŒ¨	ì‹ /êµ¬ ë²„ì „ ì„¸ì…˜ ë°ì´í„° í˜•ì‹ ë‹¤ë¦„	ë²„ì „ í”Œë˜ê·¸ ì¶”ê°€ + í˜¸í™˜ ë¡œì§
Step3 â†’ Step4 ì „í™˜ ì‹œ selectedConceptId ëˆ„ë½	prop ì „ë‹¬ ëˆ„ë½	prop ê²€ì¦ ê°•í™”
9.4 FFmpeg/ì˜ìƒ ì²˜ë¦¬ ë¦¬ìŠ¤í¬
ë¦¬ìŠ¤í¬	ì˜í–¥ë„	í•´ê²° ë°©ì•ˆ
ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜ ì‹œê°„ ì˜ˆì¸¡ ë¶ˆê°€	ğŸŸ¡ MEDIUM	ì§„í–‰ë¥  í‘œì‹œ + ì˜ˆìƒ ì‹œê°„ ì•ˆë‚´
ì˜ìƒ í•©ì„± ì‹¤íŒ¨ (FFmpeg ì˜¤ë¥˜)	ğŸ”´ HIGH	ì¬ì‹œë„ ë¡œì§ + ì˜¤ë¥˜ ë¡œê·¸ ìƒì„¸í™”
ë””ìŠ¤í¬ ìš©ëŸ‰ ë¶€ì¡± (ì´ë¯¸ì§€ 15ê°œ â†’ ì˜ìƒ 15ê°œ)	ğŸŸ¡ MEDIUM	ì„ì‹œ íŒŒì¼ ì •ë¦¬ ê°•í™” + ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
10. ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸
10.1 ë°±ì—”ë“œ ì²´í¬ë¦¬ìŠ¤íŠ¸
 api/storyboard-init.js: generateVideo() í˜¸ì¶œ ë£¨í”„ ì œê±°
 api/storyboard-init.js: compileVideos() í˜¸ì¶œ ë£¨í”„ ì œê±°
 api/storyboard-init.js: ê²°ê³¼ ë°˜í™˜ ì‹œ finalVideos: [], imageSetMode: true ì„¤ì •
 api/storyboard-init.js: ì§„í–‰ë¥  ê³„ì‚° ìˆ˜ì • (IMAGE: 40% â†’ 95%)
 api/video-status.js: ì‹ ê·œ íŒŒì¼ ìƒì„± ë° í´ë§ ë¡œì§ êµ¬í˜„
 api/image-to-video.js: ê¸°ëŠ¥ ìœ ì§€ (í˜¸ì¶œ ì‹œì ë§Œ Step4ë¡œ ë³€ê²½)
 api/compile-videos.js: ê¸°ëŠ¥ ìœ ì§€ (í˜¸ì¶œ ì‹œì ë§Œ Step4ë¡œ ë³€ê²½)
 src/utils/sessionStore.js: imageSetMode í”Œë˜ê·¸ ì§€ì›
10.2 í”„ë¡ íŠ¸ì—”ë“œ Step2 ì²´í¬ë¦¬ìŠ¤íŠ¸
 Step2.jsx: pollAndGenerateImages() ìˆ˜ì • (imageSetMode í™•ì¸)
 Step2.jsx: UI í…ìŠ¤íŠ¸ ë³€ê²½ (ì˜ìƒ â†’ ì´ë¯¸ì§€ ì„¸íŠ¸)
 Step2.jsx: ì»¨ì…‰ ë¯¸ë¦¬ë³´ê¸° UI ìˆ˜ì • (ì˜ìƒ í‘œì‹œ ì œê±°)
10.3 í”„ë¡ íŠ¸ì—”ë“œ Step3 ì²´í¬ë¦¬ìŠ¤íŠ¸
 Step3.jsx: finalVideos â†’ styles ë°ì´í„° ì†ŒìŠ¤ ë³€ê²½
 Step3.jsx: ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° UI â†’ ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ UI ì „í™˜
 Step3.jsx: handleSelectVideo() â†’ handleSelectConcept() í•¨ìˆ˜ëª… ë³€ê²½
 Step3.jsx: BGM ì ìš© UI ì œê±° (Step4ë¡œ ì´ë™)
 Step3.jsx: "Step4ë¡œ ì´ë™" ë²„íŠ¼ ì¶”ê°€
10.4 í”„ë¡ íŠ¸ì—”ë“œ Step4 ì²´í¬ë¦¬ìŠ¤íŠ¸
 Step4.jsx: sceneVideoStatus state ì¶”ê°€
 Step4.jsx: convertingScenes state ì¶”ê°€
 Step4.jsx: allScenesConfirmed state ì¶”ê°€
 Step4.jsx: handleConvertSceneToVideo() í•¨ìˆ˜ êµ¬í˜„
 Step4.jsx: pollVideoStatus() í´ë§ ë¡œì§ êµ¬í˜„
 Step4.jsx: handleConfirmAndCompile() í•¨ìˆ˜ êµ¬í˜„
 Step4.jsx: UI: ì”¬ë³„ ì˜ìƒ ë³€í™˜ ë²„íŠ¼ ì¶”ê°€
 Step4.jsx: UI: ì˜ìƒ ë³€í™˜ ìƒíƒœ í‘œì‹œ (converting/done)
 Step4.jsx: UI: ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° (ë³€í™˜ ì™„ë£Œ ì‹œ)
 Step4.jsx: UI: ì „ì²´ í™•ì • ë° í•©ì„± ë²„íŠ¼ ì¶”ê°€
 Step4.jsx: UI: BGM ì ìš© ì„¹ì…˜ ì¶”ê°€ (í•©ì„± ì™„ë£Œ í›„)
 Step4.jsx: UI: ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì¶”ê°€
10.5 App.jsx ì²´í¬ë¦¬ìŠ¤íŠ¸
 App.jsx: handleSelectProject() ìˆ˜ì • (imageSetMode í™•ì¸)
 App.jsx: í”„ë¡œì íŠ¸ ë³µêµ¬ ë¡œì§: imageSetMode ìˆìœ¼ë©´ Step3ìœ¼ë¡œ
 App.jsx: í”„ë¡œì íŠ¸ ë³µêµ¬ ë¡œì§: finalVideos ìˆìœ¼ë©´ Step4ë¡œ
10.6 í†µí•© í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
 Auto ëª¨ë“œ: í”„ë¡œì íŠ¸ ìƒì„± â†’ Step2 ì´ë¯¸ì§€ ìƒì„± â†’ Step3 ì„ íƒ â†’ Step4 í¸ì§‘ â†’ í•©ì„± â†’ ë‹¤ìš´ë¡œë“œ
 Manual ëª¨ë“œ: í”„ë¡œì íŠ¸ ìƒì„± â†’ Step2 ì´ë¯¸ì§€ ìƒì„± â†’ Step3 ì„ íƒ â†’ Step4 í¸ì§‘ â†’ í•©ì„± â†’ ë‹¤ìš´ë¡œë“œ
 í”„ë¡œì íŠ¸ ë³µêµ¬: ê¸°ì¡´ ì´ë¯¸ì§€ ì„¸íŠ¸ í”„ë¡œì íŠ¸ ë¡œë“œ â†’ Step3ìœ¼ë¡œ ì´ë™ í™•ì¸
 í”„ë¡œì íŠ¸ ë³µêµ¬: ê¸°ì¡´ ì˜ìƒ ì™„ì„± í”„ë¡œì íŠ¸ ë¡œë“œ â†’ Step4ë¡œ ì´ë™ í™•ì¸
 ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜: ì„ íƒì  ë³€í™˜ â†’ í´ë§ ì™„ë£Œ í™•ì¸
 ì „ì²´ í•©ì„±: ëª¨ë“  ì”¬ í™•ì • â†’ ìë™ ì˜ìƒ ë³€í™˜ â†’ í•©ì„± ì™„ë£Œ í™•ì¸
 BGM ì ìš©: í•©ì„± ì™„ë£Œ í›„ BGM ì ìš© â†’ ë‹¤ìš´ë¡œë“œ í™•ì¸
10.7 ë¬¸ì„œ ì—…ë°ì´íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
 UPNEXX_ì§€ì‹ë™ê¸°í™”_v3_6.md: ì‘ì—… ë¡œê·¸ ì¶”ê°€
 UPNEXX_ì§€ì‹ë™ê¸°í™”_v3_6.md: ì›Œí¬í”Œë¡œìš° ë³€ê²½ ì‚¬í•­ ê¸°ë¡
 UPNEXX_ì§€ì‹ë™ê¸°í™”_v3_6.md: ì‹ ê·œ API (video-status.js) ì¶”ê°€
 README.md: ì‚¬ìš©ì ê°€ì´ë“œ ì—…ë°ì´íŠ¸ (ì„ íƒì )
10.8 ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
 ë¡œì»¬ í™˜ê²½ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
 EC2 ë°°í¬ (ì½”ë“œ push â†’ pull)
 PM2 ì¬ì‹œì‘ (pm2 restart all)
 nginx ì„¤ì • í™•ì¸ (ë³€ê²½ ì—†ìŒ)
 CloudFront ìºì‹œ ë¬´íš¨í™” (í•„ìš” ì‹œ)
 í”„ë¡œë•ì…˜ í™˜ê²½ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸
ë¶€ë¡: ì£¼ìš” í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ë³€ê²½ ìš”ì•½
ë°±ì—”ë“œ
// api/storyboard-init.js
// ğŸ”¥ ë³€ê²½ ì „
async function handler(req, res) {
  // ... Gemini â†’ ì´ë¯¸ì§€ â†’ ì˜ìƒ â†’ í•©ì„±
  return { styles, finalVideos: [...] };
}

// âœ… ë³€ê²½ í›„
async function handler(req, res) {
  // ... Gemini â†’ ì´ë¯¸ì§€ê¹Œì§€ë§Œ
  return { styles, finalVideos: [], imageSetMode: true };
}
í”„ë¡ íŠ¸ì—”ë“œ
// src/components/Step3.jsx
// ğŸ”¥ ë³€ê²½ ì „
const finalVideos = storyboard?.finalVideos || [];
<video src={finalVideos[0].videoUrl} />

// âœ… ë³€ê²½ í›„
const styles = storyboard?.styles || [];
<img src={styles[0].images[0].imageUrl} />
// src/components/Step4.jsx
// ğŸ”¥ ì‹ ê·œ ì¶”ê°€
const handleConvertSceneToVideo = async (sceneNumber) => {
  // ê°œë³„ ì”¬ ì˜ìƒ ë³€í™˜
  const response = await fetch('/api/image-to-video', {...});
  await pollVideoStatus(response.task.taskId, sceneNumber);
};

const handleConfirmAndCompile = async () => {
  // ëª¨ë“  ì”¬ ì˜ìƒ ë³€í™˜ + í•©ì„±
  for (const scene of scenesNeedingVideo) {
    await handleConvertSceneToVideo(scene.sceneNumber);
  }
  await fetch('/api/compile-videos', {...});
};
ë¬¸ì„œ ë